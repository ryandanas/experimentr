<!DOCTYPE html>

<meta charset="utf-8">
<title>Critique Building Walkthrough Directions</title>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="experimentr.js"></script>
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en"></link>

<style>
  * {
      color: #333;
      font-family: "Open Sans", sans-serif;
    }
  body {
    margin: auto auto auto auto;
    width: 800px;
  }
  h1 {
    font-size: 150%;
    margin-top: 0em;
    margin-bottom: .5em;
    margin-left: 0;
    margin-right: 0;
    font-weight: normal;
  }
  ul, ol {
    margin-top: 0em;
    margin-bottom: 0em;
    margin-left: 0em;
    margin-right: 0em;
    padding-left: 1.5em;
  }
  b{
    font-weight: bold;
    text-shadow : 0 0 0 #333;
  }
  i {
    text-shadow : 0 0 0 #333;
  }
  u {
    text-shadow : 0 0 0 #333;
  }
  textarea {
    font-size: 80%;
    width:98%;
    height:50px;
    resize: none;
  }
  #experimentr {
    margin: 0em auto 0em auto;
    width: 800px;
  }
  #next-button {
    float: right;
    font-size: xx-large;
    font-weight: bold;
  }
  .examples, .question {
    border: 1px solid #AAA;
    border-radius: 5px;
    padding: 5px;
    margin: 0px 0px 0px 0px;
    background: #CCC;
  }
  .examples {
    width: 50%;
    float:left;
  }
  .question {
    width: 45%;
    float: right;  
  }
  .prompt, .example {
    border: 1px solid #AAA;
    border-radius: 5px;
    padding: 5px;
    background: #FFF;
    text-align:center;
  }
</style>

<body></body>

<script>
  var data = {};
  var time = Date.now();
/* OVERALL EXPERIMENT FUNCTIONS */
  function getsequence() {
    var consent = "modules/consent/";
    var t = "modules/traces/discriminate.html";
    var debrief = "modules/debrief";
    return [consent, t, debrief];
  }
  function discriminate(t, a) {
    data["task"] = t;
    data["actual"] = String(a);
    // 
    experimentr.hideNext();
    d3.select("#answer").style("display", null);
    d3.select("#pos").on("click", function(){answer(true)});
    d3.select("#neg").on("click", function(){answer(false)});
    d3.select("#feedback").text("");
    d3.select("#understood").on("click", function(){cont(true)});
    d3.select("#confused").on("click", function(){cont(false)});
    d3.select("#continue").style("display", "none");
  }
/* GENERIC TASK FUNCTIONS */
  function answer(goodorbad) {
    data["elapsed"] = (Date.now() - time) / 1000;
    time = Date.now();
    data["time"] = Date(time).toString();
    data["answer"] = String(goodorbad); 
    //
    d3.select("#answer").style("display", "none");
    d3.select("#continue").style("display", null);
    feedback();
  }
  function cont(understoodorconfused) {
    data["postId"] = null; // needed to not overwrite previous data entry
    data.comments = "n/a";
    data["understoodfeedback"] = String(understoodorconfused); 
    experimentr.addData(data);
    //
    data["elapsed"] = null;
    data["time"] = null;
    data["answer"] = null; 
    data["understoodfeedback"] = null; 
    update();
  }
  experimentr.sequence(getsequence()).start();
</script>
