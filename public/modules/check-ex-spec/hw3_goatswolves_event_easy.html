<div class="examples">
	<h1>Examples</h1>
  <div class="example">
    <button onclick="prev()">Prev</button>
    <span>Example <span id="e"></span> of 5</span></span>
    <button onclick="next()">Next</button>
    <p><button id="g" onclick="swap()"></button></p>
  </div>
  <div class="example">
    <button onclick="remGoat()">Remove</button>
    <span>Goat</span>
    <button onclick="addGoat()">Add</button>
  </div>
  <div class="example">
    <button onclick="remWolf()">Remove</button>
    <span>Wolf</span>
    <button onclick="addWolf()">Add</button>
  </div>
  <div class="example">
    <p>Pre State</p>
    <p>
      <button id="preboatnear" onclick="preBoatNear()">Boat Near</button>
      <button id="preboatfar" onclick="preBoatFar()">Boat Far</button>
    </p>
    <p id="prenear"></p>
    <p id="prefar"></p>
  </div>
  <div class="example">
    <p>Post State</p>
    <p>
      <button id="postboatnear" onclick="postBoatNear()">Boat Near</button>
      <button id="postboatfar" onclick="postBoatFar()">Boat Far</button>
    </p>
    <p id="postnear"></p>
    <p id="postfar"></p>
  </div>
</div>

<div class="checker">
  <h1>Checker</h1>
  <div class="prompt">
    <p>Produce good and bad examples of the following specification. No example should be inconsistent with the gold-standard specification. Cases you cover will appear below.</p>
    <p>Goats and Wolves River Crossing Event Transition (see homework for a more detailed description).</p>
    <p><button id="run">Run examples against specifications</button></p>
    <p>Status: <span id="out"></span></p>
  </div>
</div>

<div class="cases">
  <h1>Covered Cases</h1>
</div>

<script>
function addGoat() {
  var example = examples[e];
  example.goat = example.goat.concat(["Goat"+(example.goat.length+1)]);
  update2();
}
function remGoat() {
  var example = examples[e];
  example.prenear = example.prenear.filter(l => l != "Goat"+example.goat.length);
  example.prefar = example.prefar.filter(l => l != "Goat"+example.goat.length);
  example.postnear = example.postnear.filter(l => l != "Goat"+example.goat.length);
  example.postfar = example.postfar.filter(l => l != "Goat"+example.goat.length);
  example.goat = example.goat.filter(l => l != "Goat"+example.goat.length);
  update2();
}
function addWolf() {
  var example = examples[e];
  example.wolf = example.wolf.concat(["Wolf"+(example.wolf.length+1)]);
  update2();
}
function remWolf() {
  var example = examples[e];
  example.prenear = example.prenear.filter(l => l != "Wolf"+example.wolf.length);
  example.prefar = example.prefar.filter(l => l != "Wolf"+example.wolf.length);
  example.postnear = example.postnear.filter(l => l != "Wolf"+example.wolf.length);
  example.postfar = example.postfar.filter(l => l != "Wolf"+example.wolf.length);
  example.wolf = example.wolf.filter(l => l != "Wolf"+example.wolf.length);
  update2();
}
function preBoatNear() {
  var example = examples[e];
  example.preboat = "Near";
  update2();
}
function preBoatFar() {
  var example = examples[e];
  example.preboat = "Far";
  update2();
}
function postBoatNear() {
  var example = examples[e];
  example.postboat = "Near";
  update2();
}
function postBoatFar() {
  var example = examples[e];
  example.postboat = "Far";
  update2();
}
function update2() {
  update();
  var example = examples[e];
  d3.select("#prenear").text("Near").append("p").append("span");
  d3.select("#prefar").text("Far").append("p").append("span");
  d3.select("#postnear").text("Near").append("p").append("span");
  d3.select("#postfar").text("Far").append("p").append("span");
  var animals = example.goat.concat(example.wolf);
  for(i in animals) {
    var animal = animals[i];
    var aPreNear = example.prenear.filter(l => l == animal);
    var aPreFar = example.prefar.filter(l => l == animal);
    var aPostNear = example.postnear.filter(l => l == animal);
    var aPostFar = example.postfar.filter(l => l == animal);
    // pre near
    d3.select("#prenear").append("input")
    .attr("type", "button")
    .attr("class", function () {
      if(aPreNear.length == 0) {
        return "";
      }
      else {
        return "toggled";
      }
    })
    .attr("name", animal)
    .attr("value", animal)
    .attr("onclick", "togglePreNear(\'"+animal+"\')"); 
    // pre far
    d3.select("#prefar").append("input")
    .attr("type", "button")
    .attr("class", function () {
      if(aPreFar.length == 0) {
        return "";
      }
      else {
        return "toggled";
      }
    })
    .attr("name", animal)
    .attr("value", animal)
    .attr("onclick", "togglePreFar(\'"+animal+"\')"); 
    // post near
    d3.select("#postnear").append("input")
    .attr("type", "button")
    .attr("class", function () {
      if(aPostNear.length == 0) {
        return "";
      }
      else {
        return "toggled";
      }
    })
    .attr("name", animal)
    .attr("value", animal)
    .attr("onclick", "togglePostNear(\'"+animal+"\')"); 
    // post far
    d3.select("#postfar").append("input")
    .attr("type", "button")
    .attr("class", function () {
      if(aPostFar.length == 0) {
        return "";
      }
      else {
        return "toggled";
      }
    })
    .attr("name", animal)
    .attr("value", animal)
    .attr("onclick", "togglePostFar(\'"+animal+"\')"); 
  }
  // preboatnear
  d3.select("#preboatnear").attr("class", function () {
    if(example.preboat == "Near") {
      return "toggled";
    }
    else {
      return "";
    }
  });
  // preboatfar
  d3.select("#preboatfar").attr("class", function () {
    if(example.preboat == "Far") {
      return "toggled";
    }
    else {
      return "";
    }
  });
  // postboatnear
  d3.select("#postboatnear").attr("class", function () {
    if(example.postboat == "Near") {
      return "toggled";
    }
    else {
      return "";
    }
  });
  // postboatfar
  d3.select("#postboatfar").attr("class", function () {
    if(example.postboat == "Far") {
      return "toggled";
    }
    else {
      return "";
    }
  });
}
function togglePreNear(animal) {
  var example = examples[e];
  var aPreNear = example.prenear.filter(l => l == animal);
  if(aPreNear.length == 0) {
    example.prenear = example.prenear.concat([animal]);
  } else {
    example.prenear = example.prenear.filter(l => l != animal);
  }
  update2();
  update2();
}
function togglePreFar(animal) {
  var example = examples[e];
  var aPreFar = example.prefar.filter(l => l == animal);
  if(aPreFar.length == 0) {
    example.prefar = example.prefar.concat([animal]);
  } else {
    example.prefar = example.prefar.filter(l => l != animal);
  }
  update2();
  update2();
}
function togglePostNear(animal) {
  var example = examples[e];
  var aPostNear = example.postnear.filter(l => l == animal);
  if(aPostNear.length == 0) {
    example.postnear = example.postnear.concat([animal]);
  } else {
    example.postnear = example.postnear.filter(l => l != animal);
  }
  update2();
  update2();
}
function togglePostFar(animal) {
  var example = examples[e];
  var aPostFar = example.postfar.filter(l => l == animal);
  if(aPostFar.length == 0) {
    example.postfar = example.postfar.concat([animal]);
  } else {
    example.postfar = example.postfar.filter(l => l != animal);
  }
  update2();
  update2();
}
function graph2run(example) {
  var goats = example.goat;
  var wolves = example.wolf;
  var prenears = example.prenear;
  var prefars = example.prefar;
  var preboat = example.preboat; 
  var postnears = example.postnear;
  var postfars = example.postfar;
  var postboat = example.postboat; 
  var good = example.good;
  //
  var line1 = "";
  if(goats.length != 0) {
    line1 = "one sig ";
    for(g in goats) {
      var goat = goats[g];
      line1 += goat + ", ";
    }
    line1 = line1.substring(0, line1.length-2);
    line1 += " extends Goat {}";
  }
  //
  var line2 = "";
  if(wolves.length != 0) {
    line2 = "one sig ";
    for(g in wolves) {
      var wolf = wolves[g];
      line2 += wolf + ", ";
    }
    line2 = line2.substring(0, line2.length-2);
    line2 += " extends Wolf {}";
  }
  //
  var line3 = "run {";
  // Pre.near
  if(prenears.length == 0) {
     line3 += "no Pre.near";
  } 
  else {
    line3 += "Pre.near = ";
    for(n in prenears) {
      var prenear = prenears[n];
      line3 += prenear+"+";
    }
    line3 = line3.substring(0, line3.length-1);
  }
  line3 += " and ";
  // Pre.far
  if(prefars.length == 0) {
     line3 += "no Pre.far";
  } 
  else {
    line3 += "Pre.far = ";
    for(f in prefars) {
      var prefar = prefars[f];
      line3 += prefar+"+";
    }
    line3 = line3.substring(0, line3.length-1);
  }
  line3 += " and ";
  // Pre.boat
  line3 += "Pre.boat = "+preboat;
  line3 += " and ";
  // Post.near
  if(postnears.length == 0) {
     line3 += "no Post.near";
  } 
  else {
    line3 += "Post.near = ";
    for(n in postnears) {
      var postnear = postnears[n];
      line3 += postnear+"+";
    }
    line3 = line3.substring(0, line3.length-1);
  }
  line3 += " and ";
  // Post.far
  if(postfars.length == 0) {
     line3 += "no Post.far";
  } 
  else {
    line3 += "Post.far = ";
    for(f in postfars) {
      var postfar = postfars[f];
      line3 += postfar+"+";
    }
    line3 = line3.substring(0, line3.length-1);
  }
  line3 += " and ";
  // Post.boat
  line3 += "Post.boat = "+postboat;
  //
  line3 += "}";
  // bounds/expect
  line3 += " for exactly 2 State, exactly 1 Event, exactly "+goats.length+" Goat, exactly "+wolves.length+" Wolf, 4 Int";
  if(good) {
    line3 += " expect 1";
  } else {
    line3 += " expect 0";
  }
  //
  return line1+"\n"+line2+"\n"+line3;
}
examples = [
      {good : false, goat : [], wolf: [], prenear: [], prefar: [], preboat: "Near", postnear: [], postfar: [], postboat: "Far"},
      {good : false, goat : [], wolf: [], prenear: [], prefar: [], preboat: "Near", postnear: [], postfar: [], postboat: "Far"},
      {good : false, goat : [], wolf: [], prenear: [], prefar: [], preboat: "Near", postnear: [], postfar: [], postboat: "Far"},
      {good : false, goat : [], wolf: [], prenear: [], prefar: [], preboat: "Near", postnear: [], postfar: [], postboat: "Far"},
      {good : false, goat : [], wolf: [], prenear: [], prefar: [], preboat: "Near", postnear: [], postfar: [], postboat: "Far"}];
init();
</script>
