<div id="debrief">
  <p>
    Thank you again for your participation. Submit any additional comments below. Your unique completion ID will be displayed after you submit your comments. 
  </p>
  <p>
    <textarea name="textarea" rows="10" cols="50">Leave feedback here</textarea>
    <br>
    <button id="submitComments" disabled="true" type="button">Submit</button>
  </p>
  <p id="submitFeedback"></p>
  <p id="postId"></p>
</div>

<style></style>

<script>
  var comments = d3.select('#debrief').select('textarea')
    .on('keypress', function() { d3.select('#submitComments').attr('disabled', null); })
    .on('blur', function() { d3.select('#submitComments').attr('disabled', null); });

  d3.select('#submitComments')
    .on('click', function () { data.comments = comments.property('value'); validate(); });

  function validate() {
    if( data.comments ) {
      data.finished = true;
      data["task"] = "COMMENTS";
      data["postId"] = null; // needed to not overwrite previous data entry
      data["actual"] = "n/a";
      data["answer"] = "n/a";
      data["understoodfeedback"] = "n/a";
      data["elapsed"] = "n/a";
      data["time"] = "n/a";
      experimentr.addData(data);
      d3.select('#submitComments').attr('disabled', 'true');
      d3.select('#submitFeedback').text('Submit Successful');
      d3.select("#postId").text((+new Date()).toString(36));
    }
  }
</script>
