<div id="debrief">
  <h1>Thank you again for your participation and providing feedback below.</h1>

  <p>
    Did you solve either problem by randomly trying each option?  
      <input name="q1" id="q1y" type="radio">Yes</input>
      <input name="q1" id="q1n" type="radio">No</input>
  </p>

  <p>How many of your answers were guesses? <input id="q2" type="number" min="0"/></p>

  <p>
    Did you use the examples to solve the problems?
    <input name="q3" id="q3y" type="radio">Yes</input>
    <input name="q3" id="q3n" type="radio">No</input>
  </p>

  <textarea id="q4" rows="10" cols="40">Was there a choice you made that you thought was correct, and you were suprised to find out it was wrong? If yes, explain why you were suprised."</textarea>

  <textarea id="q5" rows="10" cols="40">Was there something you struggled with in this study? Is there something we could add that would have made the study easier to complete?</textarea>

  <br>
  <button id="submitComments" type="button">Submit</button>
  <div id="submitFeedback"></div>
  <h1>Please copy and paste the following code back on Mechanical Turk before closing this window:</h1>
  <h2 id="postId">Please submit comments first</h2>
</div>

<style>
</style>

<script>
var postId  = experimentr.postId
    , data  = {}
    , valid = false;

function validate() {
    if(d3.select("#q1y").node().checked) data['_q1_'+experimentID] = "Yes";
    if(d3.select("#q1n").node().checked) data['_q1_'+experimentID] = "No";
    var q2 = parseInt(d3.select("#q2").property("value"), 10);
    if(q2!=NaN) data['_q2_'+experimentID] = q2;
    if(d3.select("#q3y").node().checked) data['_q3_'+experimentID] = "Yes";
    if(d3.select("#q3n").node().checked) data['_q3_'+experimentID] = "No";
    data['_q4_'+experimentID] = d3.select("#q4").property("value");
    data['_q5_'+experimentID] = d3.select("#q5").property("value");

    valid = data['_q1_'+experimentID] && data['_q2_'+experimentID] && data['_q3_'+experimentID] && data['_q4_'+experimentID] && data['_q5_'+experimentID];
    if( valid ) {
      data.finished = true;
      experimentr.addData(data);
      d3.select('#submitComments').attr('disabled', 'true');
      d3.select('#submitFeedback').text('Submit Successful');
      d3.select("#postId").text(postId);
    }
    else {
      d3.select('#submitFeedback').text('Please answer all questions before submitting.');
    }
  }

function init() {
  d3.select('#q4').on('click', function(){d3.select('#q4').text("");});
  d3.select('#q5').on('click', function(){d3.select('#q5').text("");});
  d3.select('#submitComments').on('click', validate);
}
init();
</script>
