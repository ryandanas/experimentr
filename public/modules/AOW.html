<h1 id="topbar"></h1>
<div id="fixed">
  <div class="placeholder">
    You will be designing a building map. A building map keeps track of where people are located. The statements on the left describe the world the building map is designed for: these statements are always true and cannot be changed. There is an example on the right that shows what each statement means. Please read each statement/example carefully.</div>
  <ul>
    <li class="I">
        <div class="S">A building map consists of a single directory and locations.</div>
        <div class="E">&nbsp;</div>
    </li>
    <li class="I">
        <div class="S">A location is either a room or a name.</div>
        <div class="E">Example: Room 503 is a room. Alice is a name. Both are locations.</div>
    </li>
    <li class="I">
        <div class="S">Only names can have an entry in the directory.</div>
        <div class="E">Example: Room 503 cannot have an entry. Alice can have an entry.</div>
    </li>
    <li class="I">
        <div class="S">Only locations can be listed under an entry in the directory.</div>
        <div class="E">Example: Room 503 can be listed under Alice. Bob can be listed under Alice (meaning Alice has moved to Bob's listed location).</div>
    </li>
    <li class="I">
        <div class="S">We can lookup the locations of a name in the directory by successively finding the location under the entry names in the lookup.</div>
        <div class="E">Example: Alice is listed under Bob. Bob is listed under Room 503. A lookup of Alice goes from Alice to Bob, then Bob to Room 503.</div>
    </li>
  </ul>
  <div class="placeholder" id="understand">
    Understanding the each statement/example is crucial to complete the following puzzle: did they make sense to you?<br/>
    <button onclick='understand(false)'>No, they did not make sense.</button>
    <button onclick='understand(true)'>Yes, they made sense.</button>
  </div>
</div>
<div id="free">
  <div class="placeholder" id="ready">
    An almost complete building map has been designed below. The design satisfies some of the goals (green statements on the right), but not all of them (red ones). Each unsatisfied goal comes with an example of why it is unsatisfied by the current design. 
    <b>The design is only one change away from satisfying all goals. Using the example as insight, make a single change to the solution that: 1. forbids the example 2. satisfies all the goals. Do you understand how to solve the puzzle? If you do not understand the instructions, you can return the HIT, or complete it and provide feedback at the end.</b><br/>
    <button onclick='ready(false)'>No, I do not understand what to do.</button>
    <button onclick='ready(true)'>Yes, I understand what to do.</button>
  </div>
  <div class="I">
    <ul class="S">
        <li>There is <select id="T1M">a set of</select> entry(ies) in the directory.</li>
        <li>There is <select id="T2M">at most one</select> location for each entry in the directory.</li>    
        <li>All names can be an entry in the directory.</li>
        <li>In the directory, <select id="T2R"></select> can be a location for an entry.</li>
        <li>Every name in a lookup is an entry in the directory.</li>
        <li>No name is in its own lookup.</li> 
    </ul>
    <ul class="E">
      <li style="background-color:#afa">There is at most one location for every entry in the directory.</li>
      <li style="background-color:#afa">Every name in a lookup is an entry in the directory.</li>
      <li style="background-color:#afa">No name is in its own lookup.</li> 
      <li style="background-color:#faa">Every lookup of every name in the directory lists at least one room.<br/>
        Example of this failing: the lookup of Joe lists no rooms.
        <ul>
          <li>Nick is an entry.</li>
          <li>Joe is an entry.</li>
          <li>Nick is listed under the location of Joe.</li>
        </ul>
      </li>
    </ul>
  </div>
  <div class="placeholder" id="feedback"></div>
</div>

<script>
  function init2() {
    var edits = {};
    d3.select('#T1M')
    .html("<option disabled='disabled' selected='selected'>a set of</option> \
      <option id='T1M1'>exactly one</option> \
      <option id='T1M2'>at most one</option> \
      <option id='T1M3'>at least one</option>");
    edits.T1M1 = "Changing the number of entries in the directory will not forbid the missing entry in the example.";
    edits.T1M2 = "Changing the number of entries in the directory will not forbid the missing entry in the example.";
    edits.T1M3 = "Changing the number of entries in the directory will not forbid the missing entry in the example.";
    d3.select('#T2M')
    .html("<option disabled='disabled' selected='selected'>at most one</option> \
      <option id='T2M1'>a set of</option> \
      <option id='T2M2'>exactly one</option> \
      <option id='T2M3'>at least one</option>");
    edits.T2M1 = "A set can be any size.";
    edits.T2M2 = "";
    edits.T2M3 = "Having multiple locations for a name would not be a very useful building map.";
    d3.select('#T2R')
    .html("<option disabled='disabled' selected='selected'>all locations</option> \
      <option id='T2R1'>all locations that are rooms</option> \
      <option id='T2R2'>all locations that are names</option>");
    edits.T2R1 = "Restricting locations to just rooms may solve the problem, but the name redirection is a useful part of the building map. Try to solve the problem without removing this feature.";
    edits.T2R2 = "Restricting locations to just names means a room will never show up in a lookup.";
    init(edits, "Given the failing example in red, did you realize it was possible for a name to listed under a name, which is listed under a room?");
  } 
  init2();
</script>
